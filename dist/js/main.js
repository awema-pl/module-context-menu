/**
 * Bundle of AWEMA context-menu
 * Generated: 2019-07-04 10:41:20
 * Version: 1.1.2
 */

!function(){"use strict";const t="ontouchstart"in window||navigator.msMaxTouchPoints>0;let e=0;var i={name:"context-menu",props:{buttonClass:String,right:{type:Boolean,default:!1},top:{type:Boolean,default:!1},autoPosition:{type:Boolean,default:!0},boundary:{type:String,default:"body"},relocate:{type:Boolean,default:!0}},data:()=>({menuId:"cm-"+e++,isOpened:!1,clipRect:{bounds:null,toggler:{top:0,bottom:0},dropdown:{width:0,height:0}},canOpen:{left:!0,top:!0,right:!0,bottom:!0},debounce:{scroll:null,resize:null}}),computed:{boundaryElement(){if(this._isMounted){let t=this.$el.closest(this.boundary);return t||(t=document.querySelector("body")),t}return null},otsideClickEvents:()=>t?["touchstart","click"]:["click"],positionEvents(){return!!this.autoPosition&&[{event:"scroll",handler:"scrollHandler"},{event:"resize",handler:"resizeHandler"}]},position:{get(){return this.autoPosition?{right:this.right&&this.canOpen.right||this.canOpen.right&&!this.canOpen.left,top:this.top&&this.canOpen.top||this.canOpen.top&&!this.canOpen.bottom}:{right:this.right,top:this.top}},set(t){for(let e in t)this.$set(this.canOpen,e,t[e])}},positonClasses(){return{"is-opened":this.isOpened,"is-right-side":this.position.right,"is-top-side":this.position.top}},positionStyle(){if("undefined"!=typeof window&&this.relocate){let t=this.clipRect;return{position:"absolute",top:(this.position.top?t.toggler.top-t.dropdown.height:t.toggler.bottom)+window.pageYOffset+"px",left:(this.position.right?t.toggler.right-t.dropdown.width:t.toggler.left)+"px"}}return null}},watch:{isOpened(t){t?(this.otsideClickEvents.forEach(t=>{window.addEventListener(t,this.clikcOutsideHandler,!0)}),this.positionEvents&&this.positionEvents.forEach(t=>{window.addEventListener(t.event,this[t.handler],{passive:!0})})):(this.otsideClickEvents.forEach(t=>{window.removeEventListener(t,this.clikcOutsideHandler,!0)}),this.positionEvents&&this.positionEvents.forEach(t=>{window.removeEventListener(t.event,this[t.handler],{passive:!0})}))}},methods:{toggleMenu(){this.isOpened=!this.isOpened},openMenu(){this.isOpened=!0},closeMenu(){this.isOpened=!1},clikcOutsideHandler(t){let e=t.target;this.$refs.dropdown.contains(e)||this.$refs.dropdown===e||this.$refs.toggler.contains(e)||this.$refs.toggler===e||this.closeMenu()},menuClickHandler(t){(["BUTTON","A"].includes(t.target.tagName)||t.target.closest("button, a"))&&this.closeMenu()},setBoundingRect(){this.clipRect.bounds=this.boundaryElement.getBoundingClientRect()},setSelfBounds(){this.clipRect.toggler=this.$el.getBoundingClientRect()},setDropdownBounds(){this.clipRect.dropdown={width:this.$refs.dropdown.clientWidth,height:this.$refs.dropdown.clientHeight}},prepare(){this.relocate&&document.body.appendChild(this.$refs.dropdown),this.setSelfBounds()},cleanup(){this.relocate&&this.$el.appendChild(this.$refs.dropdown)},checkPosition(){this.setBoundingRect(),this.setSelfBounds(),this.setDropdownBounds(),this.autoPosition&&(this.checkCanOpenHorizontal(),this.checkCanOpenVertical())},checkCanOpenHorizontal(){const t=this.clipRect.bounds,e=this.clipRect.toggler,i=this.clipRect.dropdown;this.position={left:t.width+t.left>e.left+i.width,right:e.left-t.left>i.width-e.width}},checkCanOpenVertical(){const t=this.clipRect.bounds,e=this.clipRect.toggler,i=this.clipRect.dropdown,s={top:e.top-t.top>i.height,bottom:t.top+t.height-e.top-e.height>i.height},n={top:e.top>i.height,bottom:e.top+e.height+i.height<window.innerHeight};this.position={top:s.top&&n.top,bottom:s.bottom&&n.bottom}},scrollHandler(){clearTimeout(this.debounce.scroll),this.debounce.scroll=setTimeout(()=>{this.isOpened&&(this.setSelfBounds(),this.checkCanOpenHorizontal(),this.checkCanOpenVertical())},300)},resizeHandler(){clearTimeout(this.debounce.resize),this.debounce.resize=setTimeout(()=>{this.isOpened&&this.checkPosition()},300)}}};function s(t,e,i,s,n,o,r,c,a,l){"function"==typeof r&&(a=c,c=r,r=!1);const d="function"==typeof i?i.options:i;let h;if(t&&t.render&&(d.render=t.render,d.staticRenderFns=t.staticRenderFns,d._compiled=!0,n&&(d.functional=!0)),s&&(d._scopeId=s),o?(h=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,a(t)),t&&t._registeredComponents&&t._registeredComponents.add(o)},d._ssrRegister=h):e&&(h=r?function(){e.call(this,l(this.$root.$options.shadowRoot))}:function(t){e.call(this,c(t))}),h)if(d.functional){const t=d.render;d.render=function(e,i){return h.call(i),t(e,i)}}else{const t=d.beforeCreate;d.beforeCreate=t?[].concat(t,h):[h]}return i}const n=i;i.__file="context-menu.vue";var o=s({render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:["context-menu",t.positonClasses]},[i("button",{ref:"toggler",class:["context-menu__toggler",t.buttonClass,{"context-menu__toggler-default":!t.$slots.toggler}],attrs:{type:"button","aria-haspopup":"true"},on:{click:function(e){return e.stopPropagation(),t.toggleMenu(e)},keydown:function(e){return"button"in e||!t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?t.closeMenu(e):null}}},[t._t("toggler",[i("svg",{attrs:{width:"11",height:"3",viewBox:"0 0 600 168"}},[i("circle",{attrs:{cx:"84",cy:"84",r:"80"}}),t._v(" "),i("circle",{attrs:{cx:"300",cy:"84",r:"80"}}),t._v(" "),i("circle",{attrs:{cx:"516",cy:"84",r:"80"}})])])],2),t._v(" "),i("transition",{attrs:{name:"toggle-context-menu"},on:{beforeEnter:t.prepare,afterLeave:t.cleanup,enter:t.checkPosition}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.isOpened,expression:"isOpened"}],ref:"dropdown",class:["context-menu__dropdown",t.positonClasses],style:t.positionStyle,attrs:{"aria-expanded":t.isOpened?"true":"false"},on:{click:function(e){return e.stopPropagation(),t.menuClickHandler(e)}}},[t.$slots.default?i("ul",{staticClass:"context-menu__list"},[t._t("default")],2):t._e()])])],1)},staticRenderFns:[]},void 0,n,void 0,!1,void 0,void 0,void 0),r={inheritAttrs:!1,props:{itemClass:String}},c={name:"cm-button",mixins:[r]};const a=c;c.__file="cm-button.vue";var l=s({render:function(){var t=this.$createElement,e=this._self._c||t;return e("li",{staticClass:"cm-item"},[e("button",this._g(this._b({class:["cm-item__button",this.itemClass]},"button",this.$attrs,!1),this.$listeners),[this._t("default")],2)])},staticRenderFns:[]},void 0,a,void 0,!1,void 0,void 0,void 0),d={name:"cm-link",mixins:[r],props:{href:{type:String,required:!0}}};const h=d;d.__file="cm-link.vue";var u=s({render:function(){var t=this.$createElement,e=this._self._c||t;return e("li",{staticClass:"cm-item"},[e("a",this._g(this._b({class:["cm-item__link",this.itemClass],attrs:{href:this.href}},"a",this.$attrs,!1),this.$listeners),[this._t("default")],2)])},staticRenderFns:[]},void 0,h,void 0,!1,void 0,void 0,void 0),p={name:"cm-separator",functional:!0};const m=p;p.__file="cm-separator.vue";var _=s({render:function(t,e){return(0,e._c)("li",{staticClass:"cm-item is-separator",attrs:{role:"separator"}})},staticRenderFns:[]},void 0,m,void 0,!0,void 0,void 0,void 0),f={name:"cm-panel",functional:!0,props:{secondary:{type:Boolean,default:!1}}};const v=f;f.__file="cm-panel.vue";var g=s({render:function(t,e){var i=e._c;return i("li",{staticClass:"cm-item"},[i("div",{class:["cm-item__panel",{"is-secondary":e.props.secondary}]},[e._t("default"),e._v("\n          "+e._s(e.context)+"\n    ")],2)])},staticRenderFns:[]},void 0,v,void 0,!0,void 0,void 0,void 0),w={name:"cm-ajax",inheritAttrs:!1,mixins:[r],props:{params:{type:Object,default:()=>({})},url:{type:String,required:!0},method:{type:String,default:"post",validator:t=>["get","put","post","delete","patch"].includes(t.toLowerCase())}},methods:{fetchData(){AWEMA.ajax(this.params,this.url,this.method).then(t=>{this.$emit("sended",t)}).catch(t=>{this.$emit("error",t)})}}};const b=w;w.__file="cm-ajax.vue";var y=s({render:function(){var t=this.$createElement,e=this._self._c||t;return e("li",{staticClass:"cm-item"},[e("button",this._b({class:["cm-item__button",this.itemClass],on:{click:this.fetchData}},"button",this.$attrs,!1),[this._t("default")],2)])},staticRenderFns:[]},void 0,b,void 0,!1,void 0,void 0,void 0),C={name:"cm-query",mixins:[r],props:{param:{type:Object,required:!0}},computed:{routeQuery(){return this.$route.query},isActive(){let t=!0;for(let e in this.param)t=t&&(this.routeQuery.hasOwnProperty(e)?this.routeQuery[e]===this.param[e]:""===this.param[e]);return t}},methods:{setQuery(){this.isActive||this.$router.push({query:this.getMergedQuery()})},getMergedQuery(){return Object.assign({},this.routeQuery,this.param)}},beforeCreate(){this._routerRoot=this,this._router=AWEMA._vueRouter,this._router.init(this),Vue.util.defineReactive(this,"_route",this._router.history.current)}};const O=C;C.__file="cm-query.vue";var $=s({render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",{staticClass:"cm-item"},[i("button",t._g(t._b({class:["cm-item__button",{"is-active":t.isActive},t.itemClass],on:{click:t.setQuery}},"button",t.$attrs,!1),t.$listeners),[t._t("default")],2)])},staticRenderFns:[]},void 0,O,void 0,!1,void 0,void 0,void 0);var k={installed:!1,install:function(t){this.installed||(this.installed=!0,t.component("context-menu",o),t.component("cm-button",l),t.component("cm-link",u),t.component("cm-separator",_),t.component("cm-panel",g),t.component("cm-ajax",y),t.component("cm-query",$))}};const E={install(){Vue.use(k)}};"AWEMA"in window?AWEMA.use(E):(window.__awema_plugins_stack__=window.__awema_plugins_stack__||[],window.__awema_plugins_stack__.push(E))}();
